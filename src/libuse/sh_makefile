DESTDIR=/
PREFIX=${DESTDIR}usr
APPNAME=usenew
VER=0.1
prefix=/usr
install_prefix=$prefix
install=/usr/bin/install
git_rev=$(./../../tools/git_revgen )

# option vars for libuse.input.parse_input()
LIBUSE_INPUT_PARSER_STD_LONG=stub
LIBUSE_INPUT_PARSER_STD_SHORT=stub
LIBUSE_INPUT_PARSER_STD_EXEC=stub


default() {
	libuse
}


prepare() {
	mkdir -p $PREFIX/lib/libuse
}



libuse() {
	shpp -Dgit_rev=$git_rev -Dprefix=$PREFIX libuse.backup.in  -o libuse.backup
	shpp -Dgit_rev=$git_rev libuse.winix_app.in -o libuse.winix_app
	shpp -Dgit_rev=$git_rev libuse.wine_misc.in -o libuse.wine_misc
	if [ $LIBUSE_INPUT_NEW ] ; then
		shpp -Dgit_rev=$git_rev -Dprefix=$PREFIX -DDEFAULT_STD_OPTIONS_LONG=$LIBUSE_INPUT_PARSER_STD_LONG \
		-DDEFAULT_STD_OPTIONS_SHORT=$LIBUSE_INPUT_PARSER_STD_SHORT -DDEFAULT_STD_OPTIONS_EXEC=$LIBUSE_INPUT_PARSER_STD_EXEC \
		libuse.input.in -o libuse.input
	else
		shpp -Dgit_rev=$git_rev -Dprefix=$PREFIX libuse.input_old.in -o libuse.input_old
	fi
	shpp -Dgit_rev=$git_rev -Dprefix=$PREFIX libuse_v4.in -o libuse_v4
}

install() {
	prepare			
	install_libuse
}
install_libuse() {
	$install libuse.backup $PREFIX/lib/libuse/libuse.backup
	$install libuse.winix_app $PREFIX/lib/libuse/libuse.winix_app
	$install libuse.wine_misc $PREFIX/lib/libuse/libuse.wine_misc
	$install libuse.input	$PREFIX/lib/libuse/libuse.input
	$install libuse_v4 	$PREFIX/lib/libuse/libuse_v4
	ln -s libuse_v4		$PREFIX/lib/libuse/libuse
}

clean() {
	rm -rf libuse.backup
	rm -rf libuse.winix_app
	rm -rf libuse.wine_misc
	rm -rf libuse.input_old
	rm -rf libuse.input
	rm -rf libuse_v4

}
